<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendário de Estudos Moderno</title>
<style>
:root {
--primary: #4caf50;
--primary-light: #5cb860;
--secondary: #2196f3;
--secondary-light: #4dabf5;
--danger: #f44336;
--warning: #ff9800;
--bg: #121212;
--bg-light: #1e1e1e;
--bg-lighter: #2d2d2d;
--text: #ffffff;
--text-secondary: #b3b3b3;
--dashboard-width: 300px;
--slider-handle-size: 24px;
--border-radius: 12px;
--transition: all 0.3s ease;
--shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
--chart-color-1: #A8D5BA;
--chart-color-2: #90CAF9;
--chart-color-3: #FFCC80;
--chart-color-4: #EF9A9A;
--chart-color-5: #C5B4E3;
}
/* TEMA CLARO ATUALIZADO - mais escuro e confortável */
.light-theme {
/* Paleta principal */
--primary: #7CAF92; /* Verde mais escuro */
--primary-light: #9CC0A9; /* Verde mais claro */
--secondary: #6BA6D9; /* Azul mais escuro */
--secondary-light: #8ABDE6; /* Azul mais claro */
--danger: #D67F7F; /* Vermelho mais escuro */
--warning: #E6B366; /* Laranja mais escuro */
/* Fundos mais escuros */
--bg: #f0f4f8; /* Azul cinza mais suave */
--bg-light: #e6e9ed; /* Cinza claro mais escuro */
--bg-lighter: #d6dbe0; /* Tom mais escuro */
/* Textos com mais contraste */
--text: #2d3748; /* Preto suave mais escuro */
--text-secondary: #4a5568; /* Cinza mais escuro */
/* Sombras mais suaves */
--shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
/* Cores para gráficos - mais saturadas */
--chart-color-1: #7CAF92;
--chart-color-2: #6BA6D9;
--chart-color-3: #E6B366;
--chart-color-4: #D67F7F;
--chart-color-5: #A997D6;
}
* {
box-sizing: border-box;
margin: 0;
padding: 0;
}
body {
font-family: 'Poppins', sans-serif;
margin: 0;
padding: 20px;
background: var(--bg);
color: var(--text);
min-height: 100vh;
line-height: 1.6;
transition: background 0.5s ease, color 0.5s ease;
}
.container {
display: grid;
grid-template-columns: 1fr var(--dashboard-width);
gap: 20px;
width: 100%;
max-width: 1200px;
margin: 0 auto;
}
/* Botão de alternância de tema */
.theme-toggle {
position: fixed;
top: 20px;
right: 20px;
background: var(--bg-light);
color: var(--text);
border: none;
width: 50px;
height: 50px;
border-radius: 50%;
cursor: pointer;
z-index: 1000;
display: flex;
align-items: center;
justify-content: center;
font-size: 20px;
box-shadow: var(--shadow);
transition: var(--transition);
}
.theme-toggle:hover {
transform: scale(1.1);
}
/* Estilos do Calendário */
.calendar {
background: var(--bg-light);
border-radius: var(--border-radius);
padding: 20px;
box-shadow: var(--shadow);
position: relative;
overflow: hidden;
}
.calendar-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
background: var(--primary);
padding: 15px;
border-radius: 10px;
}
.calendar-header button {
background: rgba(255, 255, 255, 0.15);
border: none;
color: var(--text);
font-size: 20px;
cursor: pointer;
padding: 8px 12px;
border-radius: 8px;
transition: var(--transition);
display: flex;
align-items: center;
justify-content: center;
}
.calendar-header button:hover {
background: rgba(255, 255, 255, 0.25);
}
.calendar-grid {
display: grid;
grid-template-columns: repeat(7, 1fr);
gap: 6px;
}
.calendar-grid .day {
font-weight: 600;
color: var(--text-secondary);
padding: 12px 8px;
text-align: center;
font-size: 14px;
text-transform: uppercase;
letter-spacing: 0.5px;
}
.calendar-grid .date {
aspect-ratio: 1.1;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
background: var(--bg-lighter);
cursor: pointer;
border-radius: 10px;
transition: var(--transition);
position: relative;
font-size: 16px;
font-weight: 500;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.calendar-grid .date:hover {
background: var(--bg);
transform: translateY(-3px);
}
.calendar-grid .today {
background: var(--primary);
font-weight: bold;
color: white;
}
.task-dot {
width: 8px;
height: 8px;
background: var(--secondary);
border-radius: 50%;
margin-top: 6px;
position: absolute;
bottom: 8px;
}
/* Estilos do Modal de Detalhes */
.day-details {
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
width: 90%;
max-width: 500px;
max-height: 85vh;
display: none;
z-index: 100;
flex-direction: column;
background: var(--bg-light);
border-radius: var(--border-radius);
overflow: hidden;
box-shadow: var(--shadow);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.day-details.active {
display: flex;
}
.day-details-header {
padding: 20px;
border-bottom: 1px solid rgba(0, 0, 0, 0.05);
position: relative;
background: var(--primary);
}
.close-details {
position: absolute;
top: 15px;
right: 15px;
background: rgba(0, 0, 0, 0.2);
border: none;
color: var(--text);
font-size: 24px;
cursor: pointer;
width: 36px;
height: 36px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: var(--transition);
}
.close-details:hover {
background: rgba(0, 0, 0, 0.4);
}
.day-details-content {
flex: 1;
overflow-y: auto;
padding: 20px;
}
.day-details-content::-webkit-scrollbar {
width: 8px;
}
.day-details-content::-webkit-scrollbar-track {
background: var(--bg-lighter);
border-radius: 4px;
}
.day-details-content::-webkit-scrollbar-thumb {
background: var(--primary);
border-radius: 4px;
}
/* Estilos do Sistema de Estudos */
.study-tracker {
margin-bottom: 25px;
background: var(--bg-lighter);
border-radius: var(--border-radius);
padding: 20px;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.study-form {
display: grid;
grid-template-columns: 1fr;
gap: 15px;
margin-bottom: 20px;
}
.study-input {
padding: 14px;
border-radius: 8px;
border: 1px solid rgba(0, 0, 0, 0.05);
background: var(--bg-light);
color: var(--text);
width: 100%;
font-family: inherit;
font-size: 15px;
}
.subject-input-container {
position: relative;
}
.subject-input-container i {
position: absolute;
right: 12px;
top: 50%;
transform: translateY(-50%);
color: #aaa;
}
.time-controls-container {
background: var(--bg-light);
border-radius: 8px;
padding: 20px;
position: relative;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.slider-header {
display: flex;
justify-content: space-between;
margin-bottom: 15px;
}
.slider-value {
font-weight: bold;
color: var(--primary);
font-size: 18px;
}
.time-slider {
-webkit-appearance: none;
width: 100%;
height: 8px;
border-radius: 4px;
background: rgba(0, 0, 0, 0.05);
outline: none;
margin: 15px 0;
}
.time-slider::-webkit-slider-thumb {
-webkit-appearance: none;
width: var(--slider-handle-size);
height: var(--slider-handle-size);
border-radius: 50%;
background: var(--primary);
cursor: pointer;
transition: var(--transition);
border: 2px solid white;
}
.time-slider::-webkit-slider-thumb:hover {
transform: scale(1.1);
}
.slider-markers {
display: flex;
justify-content: space-between;
position: relative;
margin-top: 5px;
}
.slider-marker {
position: relative;
text-align: center;
width: 0;
font-size: 11px;
color: #aaa;
}
.slider-marker::before {
content: "";
position: absolute;
top: -10px;
left: 0;
width: 2px;
height: 5px;
background: #555;
transform: translateX(-50%);
}
.session-list {
list-style: none;
padding: 0;
margin: 0;
max-height: 200px;
overflow-y: auto;
}
.session-item {
display: flex;
justify-content: space-between;
align-items: center;
padding: 14px;
margin: 10px 0;
background: var(--bg-light);
border-radius: 8px;
transition: var(--transition);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.session-item:hover {
background: var(--bg);
}
.time-total {
margin-top: 15px;
padding: 15px;
background: var(--bg-light);
border-radius: 8px;
display: flex;
justify-content: space-between;
font-weight: 600;
font-size: 16px;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.progress-bar {
height: 8px;
background: rgba(0, 0, 0, 0.05);
border-radius: 4px;
margin-top: 10px;
overflow: hidden;
}
.progress-fill {
height: 100%;
background: var(--primary);
transition: width 0.3s ease;
}
/* Botões de tempo */
.time-buttons {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 10px;
margin: 15px 0;
}
.time-btn {
padding: 10px;
background: var(--bg-light);
border: 1px solid rgba(0, 0, 0, 0.05);
border-radius: 8px;
color: var(--text);
cursor: pointer;
transition: var(--transition);
font-family: inherit;
font-size: 14px;
text-align: center;
}
.time-btn:hover {
background: var(--primary);
transform: translateY(-2px);
color: white;
}
.time-btn.active {
background: var(--primary);
border-color: var(--primary-light);
color: white;
}
.custom-time {
display: flex;
gap: 10px;
margin-top: 10px;
}
.custom-time input {
flex: 1;
padding: 12px;
border-radius: 8px;
border: 1px solid rgba(0, 0, 0, 0.05);
background: var(--bg-light);
color: var(--text);
font-family: inherit;
}
/* Estilos do Dashboard */
.dashboard {
background: var(--bg-light);
border-radius: var(--border-radius);
padding: 20px;
height: 80vh;
position: sticky;
top: 20px;
box-shadow: var(--shadow);
display: flex;
flex-direction: column;
gap: 20px;
overflow-y: auto;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.stat-card {
background: var(--bg-lighter);
border-radius: var(--border-radius);
padding: 20px;
transition: var(--transition);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.stat-card:hover {
transform: translateY(-5px);
}
.stat-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 15px;
}
.stat-title {
color: var(--text-secondary); /* Cinza médio para títulos */
font-size: 14px;
font-weight: 500;
text-transform: uppercase;
letter-spacing: 0.5px;
}
/* FIX: Ícones perfeitamente circulares */
.stat-icon {
width: 36px;
height: 36px;
border-radius: 50%;
background: rgba(168, 213, 186, 0.3); /* Verde pastel com transparência */
display: flex;
align-items: center;
justify-content: center;
font-size: 16px;
color: var(--primary);
flex-shrink: 0; /* Impede distorção */
}
.stat-value {
font-size: 28px;
font-weight: 700; /* Mais peso para valor */
margin-top: 5px;
color: var(--text); /* Texto escuro para melhor contraste */
}
.chart-container {
height: 200px;
position: relative;
}
.subject-list {
list-style: none;
padding: 0;
margin: 0;
}
.subject-item {
display: flex;
justify-content: space-between;
padding: 12px 0;
border-bottom: 1px solid rgba(0, 0, 0, 0.05);
font-size: 15px;
}
.subject-item:last-child {
border-bottom: none;
}
.subject-item span:first-child {
color: var(--text-secondary); /* Texto mais suave para disciplina */
}
.subject-item span:last-child {
font-weight: 600; /* Destaque para o tempo */
}
/* Categorias */
.categories {
margin-top: 25px;
border-top: 1px solid rgba(0, 0, 0, 0.05);
padding-top: 20px;
}
.category {
margin-bottom: 20px;
}
.category h3 {
margin-bottom: 15px;
color: var(--primary);
display: flex;
align-items: center;
gap: 10px;
font-size: 16px;
font-weight: 600; /* Mais peso para títulos */
}
.category h3 i {
font-size: 18px;
}
.task-input-group {
display: flex;
gap: 10px;
margin-bottom: 15px;
}
.task-input {
flex: 1;
padding: 12px;
border: 1px solid rgba(0, 0, 0, 0.05);
border-radius: 8px;
background: var(--bg-light);
color: var(--text);
font-family: inherit;
font-size: 15px;
}
.add-btn {
background: var(--primary);
border: none;
color: white;
padding: 12px 18px;
border-radius: 8px;
cursor: pointer;
transition: var(--transition);
font-family: inherit;
font-size: 15px;
font-weight: 500;
display: flex;
align-items: center;
gap: 8px;
}
.add-btn:hover {
background: var(--primary-light);
transform: translateY(-2px);
}
.tasks-list {
list-style: none;
padding: 0;
margin: 0;
display: flex;
flex-direction: column;
gap: 10px;
}
.task-item {
display: flex;
align-items: center;
gap: 10px;
padding: 12px;
background: var(--bg-lighter);
border-radius: 8px;
animation: fadeIn 0.3s ease;
transition: var(--transition);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.task-item:hover {
background: var(--bg);
}
.task-text {
flex: 1;
word-break: break-word;
font-size: 15px;
}
.task-text[contenteditable="true"] {
background: rgba(0, 0, 0, 0.02);
padding: 8px;
border-radius: 6px;
outline: none;
}
.task-actions {
display: flex;
gap: 8px;
}
.task-btn {
background: none;
border: none;
color: var(--text);
cursor: pointer;
padding: 6px;
border-radius: 6px;
transition: var(--transition);
width: 32px;
height: 32px;
display: flex;
align-items: center;
justify-content: center;
}
.task-btn.complete:hover {
background: rgba(168, 213, 186, 0.3); /* Verde pastel claro */
color: var(--primary);
}
.task-btn.remove:hover {
background: rgba(239, 154, 154, 0.3); /* Vermelho pastel claro */
color: var(--danger);
}
/* Botão de cadastro de disciplinas */
.subjects-button-container {
margin-top: 20px;
text-align: center;
}
.subjects-button {
background: var(--secondary); /* Azul pastel */
border: none;
color: white;
padding: 14px 24px;
border-radius: 8px;
cursor: pointer;
font-family: inherit;
font-weight: 500;
transition: var(--transition);
display: inline-flex;
align-items: center;
gap: 10px;
font-size: 16px;
}
.subjects-button:hover {
background: var(--secondary-light);
transform: translateY(-3px);
}
/* Dropdown para disciplinas */
.subject-select {
padding: 14px;
border-radius: 8px;
border: 1px solid rgba(0, 0, 0, 0.05);
background: var(--bg-light);
color: var(--text);
width: 100%;
font-family: inherit;
font-size: 15px;
cursor: pointer;
appearance: none;
background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
background-repeat: no-repeat;
background-position: right 12px center;
background-size: 18px;
}
.subject-select option {
background: var(--bg-light);
color: var(--text);
}
/* Modal para matérias */
.modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.7);
z-index: 1000;
justify-content: center;
align-items: center;
}
.modal.active {
display: flex;
}
.modal-content {
background: var(--bg-light);
border-radius: var(--border-radius);
padding: 30px;
width: 90%;
max-width: 450px;
box-shadow: var(--shadow);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.modal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 25px;
}
.modal-header h2 {
font-size: 24px;
font-weight: 600; /* Mais peso para título do modal */
color: var(--text);
}
.close-modal {
background: rgba(0, 0, 0, 0.1);
border: none;
color: var(--text);
font-size: 24px;
cursor: pointer;
width: 36px;
height: 36px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: var(--transition);
}
.close-modal:hover {
background: rgba(0, 0, 0, 0.2);
}
.subject-list-container {
max-height: 300px;
overflow-y: auto;
margin-bottom: 20px;
}
.subject-list-item {
padding: 14px;
background: var(--bg-lighter);
border-radius: 8px;
margin-bottom: 12px;
display: flex;
justify-content: space-between;
align-items: center;
transition: var(--transition);
border: 1px solid rgba(0, 0, 0, 0.05);
}
.subject-list-item:hover {
background: var(--bg);
}
.subject-list-item:last-child {
margin-bottom: 0;
}
.subject-actions {
display: flex;
gap: 12px;
}
.subject-action-btn {
background: none;
border: none;
color: #aaa;
cursor: pointer;
font-size: 20px;
transition: var(--transition);
width: 36px;
height: 36px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
}
.subject-action-btn:hover {
background: rgba(0, 0, 0, 0.05);
}
.subject-action-btn.use:hover {
color: var(--primary);
}
.subject-action-btn.delete:hover {
color: var(--danger);
}
.subject-form {
display: flex;
gap: 12px;
margin-top: 25px;
}
.subject-input {
flex: 1;
padding: 14px;
border-radius: 8px;
border: 1px solid rgba(0, 0, 0, 0.05);
background: var(--bg-lighter);
color: var(--text);
font-family: inherit;
font-size: 15px;
}
/* Botões de exportação/importação */
.study-data-buttons {
position: fixed;
bottom: 30px;
right: 30px;
z-index: 9999;
display: flex;
gap: 15px;
}
.study-data-btn {
background: rgba(40, 40, 40, 0.8);
color: rgba(255, 255, 255, 0.9);
border: 1px solid rgba(255, 255, 255, 0.1);
padding: 14px 25px;
border-radius: 50px;
cursor: pointer;
font-family: inherit;
font-weight: 500;
transition: var(--transition);
display: flex;
align-items: center;
gap: 10px;
font-size: 15px;
}
.study-data-btn.import {
background: rgba(144, 202, 249, 0.6); /* Azul pastel com transparência */
border-color: rgba(144, 202, 249, 0.8);
color: var(--text);
}
.study-data-btn:hover {
background: rgba(60, 60, 60, 0.9);
color: rgba(255, 255, 255, 1);
border-color: rgba(255, 255, 255, 0.3);
transform: translateY(-3px);
}
.study-data-btn.import:hover {
background: rgba(144, 202, 249, 0.8);
color: var(--text);
}
.study-data-btn:active {
transform: translateY(1px);
}
.study-data-btn i {
font-size: 1.1em;
opacity: 0.9;
transition: opacity 0.3s ease;
}
.study-data-btn:hover i {
opacity: 1;
}
/* Gráfico de rosca */
.chart-legend {
max-height: 200px;
overflow-y: auto;
padding: 10px;
background: var(--bg-light);
border-radius: 8px;
margin-top: 15px;
display: grid;
grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
gap: 10px;
border: 1px solid rgba(0, 0, 0, 0.05);
}
.legend-item {
display: flex;
align-items: center;
gap: 8px;
font-size: 13px;
}
.legend-color {
width: 12px;
height: 12px;
border-radius: 50%;
}
.legend-text {
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap;
color: var(--text-secondary); /* Texto mais suave para legenda */
}
/* BARRA DE PROGRESSO DE METAS */
.goal-progress {
display: flex;
flex-direction: column;
gap: 20px;
margin-top: 15px;
}
.goal-item {
margin-bottom: 10px;
}
.goal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 8px;
}
.goal-title {
font-size: 14px;
font-weight: 500;
color: var(--text-secondary); /* Texto mais suave para título */
}
.goal-value {
font-size: 12px;
text-align: right;
margin-top: 5px;
color: var(--text-secondary);
}
/* Modal para metas */
.goal-modal {
max-width: 400px;
}
.goal-setting {
margin-bottom: 20px;
}
.goal-setting label {
display: block;
margin-bottom: 8px;
font-weight: 500;
color: var(--text-secondary);
}
/* ANIMAÇÃO DE META ATINGIDA */
@keyframes confetti {
0% { transform: translateY(0) rotate(0); opacity: 1; }
100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
}
.confetti {
position: fixed;
width: 10px;
height: 10px;
background: var(--primary);
opacity: 0;
z-index: 10000;
animation: confetti 1s ease-out forwards;
}
/* Notificação temporária */
.notification {
position: fixed;
top: 20px;
right: 20px;
padding: 15px 25px;
background: var(--primary);
color: white;
border-radius: 8px;
z-index: 2000;
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
transition: all 0.5s ease;
opacity: 0;
transform: translateX(100%);
}
.notification.show {
opacity: 1;
transform: translateX(0);
}
/* Mobile */
@media (max-width: 768px) {
.container {
grid-template-columns: 1fr;
}
.dashboard {
position: static;
height: auto;
max-height: 50vh;
}
.study-data-buttons {
bottom: 20px;
right: 20px;
flex-direction: column;
}
.study-data-btn {
padding: 12px 20px;
font-size: 14px;
}
.time-buttons {
grid-template-columns: repeat(3, 1fr);
}
}
@media (max-width: 480px) {
.calendar-grid .date {
aspect-ratio: 1;
font-size: 14px;
padding: 8px;
}
.study-form, .task-input-group {
grid-template-columns: 1fr;
}
.time-buttons {
grid-template-columns: repeat(2, 1fr);
}
}
/* Animações */
@keyframes fadeIn {
from { opacity: 0; transform: translateY(-10px); }
to { opacity: 1; transform: translateY(0); }
}
@keyframes slideIn {
from { transform: translateY(20px); opacity: 0; }
to { transform: translateY(0); opacity: 1; }
}
.animate {
animation: slideIn 0.5s ease-out;
}
/* Largura da barra de rolagem */
::-webkit-scrollbar {
width: 10px;
}
::-webkit-scrollbar-track {
background: var(--bg-lighter);
border-radius: 10px;
}
::-webkit-scrollbar-thumb {
background: var(--primary);
border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover {
background: var(--primary-light);
}
/* ESTILOS ADICIONAIS PARA AS NOVAS FUNCIONALIDADES */
.calendar-grid .date.completed {
    background: var(--bg-lighter);
    border-radius: 8px;
    position: relative;
}

.calendar-grid .date.completed {
    position: relative;
    background: var(--bg-lighter);
    border: 2px solid var(--primary);
}

.calendar-grid .date.completed::after {
    content: "✓";
    position: absolute;
    top: 5px;
    right: 5px;
    color: var(--primary);
    font-weight: bold;
    font-size: 14px;
}





.subject-edit-input {
    background: var(--bg-light);
    color: var(--text);
    border: 1px solid var(--primary);
    border-radius: 6px;
    padding: 8px 12px;
    width: 100%;
    font-family: inherit;
    font-size: 15px;
}
.edit-mode .subject-text {
    display: none;
}
.edit-mode .subject-edit-input {
    display: block;
}
.subject-edit-input {
    display: none;
}
.fa-pen {
    font-size: 14px;
}
</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<button id="theme-toggle" class="theme-toggle">
<i class="fas fa-moon"></i>
</button>
<div class="notification" id="notification">
Parabéns! Você atingiu sua meta mensal! 🎉
</div>
<div class="container">
<!-- Seção do Calendário -->
<div class="animate">
<div class="calendar" id="calendar">
<div class="calendar-header">
<button id="prev"><i class="fas fa-chevron-left"></i></button>
<h2 id="month-year"></h2>
<button id="next"><i class="fas fa-chevron-right"></i></button>
</div>
<div class="calendar-grid" id="calendar-grid">
<div class="day">Dom</div>
<div class="day">Seg</div>
<div class="day">Ter</div>
<div class="day">Qua</div>
<div class="day">Qui</div>
<div class="day">Sex</div>
<div class="day">Sáb</div>
</div>
</div>
<!-- Botão para cadastrar disciplinas -->
<div class="subjects-button-container">
<button class="subjects-button" onclick="openSubjectsModal()">
<i class="fas fa-book"></i> Cadastrar Disciplinas
</button>
</div>
<!-- Modal de Detalhes do Dia -->
<div class="day-details" id="day-details">
<div class="day-details-header">
<button class="close-details" onclick="closeDayDetails()">&times;</button>
<h2 id="day-title"></h2>
</div>
<div class="day-details-content">
<div class="study-tracker">
<div class="study-form">
<select class="subject-select" id="study-subject">
<option value="" selected disabled>Selecione uma disciplina</option>
</select>
<div class="time-controls-container">
<div class="slider-header">
<span>Tempo de Estudo</span>
<span class="slider-value" id="slider-value">0h 00m</span>
</div>
<!-- Botões de tempo pré-definidos -->
<div class="time-buttons">
<button class="time-btn" data-minutes="15">15 min</button>
<button class="time-btn" data-minutes="30">30 min</button>
<button class="time-btn" data-minutes="45">45 min</button>
<button class="time-btn" data-minutes="60">60 min</button>
</div>
<!-- Campo de tempo personalizado -->
<div class="custom-time">
<input type="number" id="custom-minutes" placeholder="Minutos" min="0" max="60">
<button class="add-btn" onclick="setCustomTime()">
<i class="fas fa-check"></i>
</button>
</div>
<input type="range" min="0" max="60" value="0" class="time-slider" id="study-time">
<div class="slider-markers">
<span class="slider-marker">0</span>
<span class="slider-marker">15</span>
<span class="slider-marker">30</span>
<span class="slider-marker">45</span>
<span class="slider-marker">60</span>
</div>
</div>
<button class="add-btn" onclick="addStudySession()">
<i class="fas fa-plus"></i> Adicionar Sessão
</button>
</div>
<div class="time-total">
<span>Tempo Total:</span>
<span id="total-time">0h 00m</span>
</div>
<div class="progress-bar">
<div class="progress-fill" id="study-progress"></div>
</div>
<ul class="session-list" id="session-list"></ul>
</div>
<div class="categories">
<div class="category">
<h3><i class="fas fa-question"></i>Questões</h3>
<div class="task-input-group">
<input type="text" class="task-input" id="new-questions" placeholder="Nova questão">
<button class="add-btn" data-category="questions">
<i class="fas fa-plus"></i> Adicionar
</button>
</div>
<ul class="tasks-list" id="questions"></ul>
</div>
<div class="category">
<h3><i class="fas fa-book-open"></i>Aulas</h3>
<div class="task-input-group">
<input type="text" class="task-input" id="new-lessons" placeholder="Nova aula">
<button class="add-btn" data-category="lessons">
<i class="fas fa-plus"></i> Adicionar
</button>
</div>
<ul class="tasks-list" id="lessons"></ul>
</div>
<div class="category">
<h3><i class="fas fa-layer-group"></i>Flashcards</h3>
<div class="task-input-group">
<input type="text" class="task-input" id="new-flashcards" placeholder="Novo flashcard">
<button class="add-btn" data-category="flashcards">
<i class="fas fa-plus"></i> Adicionar
</button>
</div>
<ul class="tasks-list" id="flashcards"></ul>
</div>
<!-- NOVA CATEGORIA: CORREÇÕES DE QUESTÕES -->
<div class="category">
    <h3><i class="fas fa-check-double"></i>Correções de Questões</h3>
    <div class="task-input-group">
        <input type="text" class="task-input" id="new-corrections" placeholder="Nova correção">
        <button class="add-btn" data-category="corrections">
            <i class="fas fa-plus"></i> Adicionar
        </button>
    </div>
    <ul class="tasks-list" id="corrections"></ul>
</div>
</div>
</div>
</div>
</div>
<!-- Dashboard -->
<div class="dashboard">
<div class="stat-card animate" style="animation-delay: 0.1s">
<div class="stat-header">
<span class="stat-title">Tempo Total Estudado</span>
<div class="stat-icon">
<i class="fas fa-clock"></i>
</div>
</div>
<div class="stat-value" id="total-studied">0h 00m</div>
</div>
<!-- BOX DE METAS REPOSICIONADO E SIMPLIFICADO -->
<div class="stat-card animate" style="animation-delay: 0.05s">
<div class="stat-header">
<span class="stat-title">Metas de Estudo</span>
<div class="stat-icon" onclick="openGoalModal()">
<i class="fas fa-cog"></i>
</div>
</div>
<div class="goal-progress">
<div class="goal-item">
<div class="goal-header">
<div class="goal-title">Meta Semanal</div>
</div>
<div class="progress-bar">
<div class="progress-fill" id="weekly-progress"></div>
</div>
<div class="goal-value" id="weekly-value">0/0 horas</div>
</div>
<div class="goal-item">
<div class="goal-header">
<div class="goal-title">Meta Mensal</div>
</div>
<div class="progress-bar">
<div class="progress-fill" id="monthly-progress"></div>
</div>
<div class="goal-value" id="monthly-value">0/0 horas</div>
</div>
</div>
</div>
<div class="stat-card animate" style="animation-delay: 0.2s">
<div class="stat-header">
<span class="stat-title">Distribuição por Disciplina</span>
<div class="stat-icon">
<i class="fas fa-chart-pie"></i>
</div>
</div>
<div class="chart-container">
<canvas id="subjectChart"></canvas>
</div>
<div class="chart-legend" id="chart-legend"></div>
</div>
<div class="stat-card animate" style="animation-delay: 0.3s">
<div class="stat-header">
<span class="stat-title">Disciplinas Mais Estudadas</span>
<div class="stat-icon">
<i class="fas fa-list-ol"></i>
</div>
</div>
<ul class="subject-list" id="topSubjects"></ul>
</div>
<div class="stat-card animate" style="animation-delay: 0.4s">
<div class="stat-header">
<span class="stat-title">Média Diária</span>
<div class="stat-icon">
<i class="fas fa-chart-line"></i>
</div>
</div>
<div class="stat-value" id="daily-average">0h 00m</div>
</div>
</div>
</div>
<!-- Modal de Gerenciamento de Matérias -->
<div class="modal" id="subjects-modal">
<div class="modal-content">
<div class="modal-header">
<h2>Minhas Disciplinas</h2>
<button class="close-modal" onclick="closeSubjectsModal()">&times;</button>
</div>
<div class="subject-list-container" id="subject-list-container">
<!-- As matérias serão carregadas aqui -->
</div>
<div class="subject-form">
<input type="text" class="subject-input" id="new-subject" placeholder="Nova disciplina">
<button class="add-btn" onclick="addNewSubject()">
<i class="fas fa-plus"></i> Adicionar
</button>
</div>
</div>
</div>
<!-- Modal de Configuração de Metas -->
<div class="modal" id="goal-modal">
<div class="modal-content goal-modal">
<div class="modal-header">
<h2>Configurar Metas</h2>
<button class="close-modal" onclick="closeGoalModal()">&times;</button>
</div>
<div class="modal-body">
<div class="goal-setting">
<label for="weekly-goal">Meta Semanal (horas):</label>
<input type="number" id="weekly-goal" min="0" step="0.5" class="study-input">
</div>
<div class="goal-setting">
<label for="monthly-goal">Meta Mensal (horas):</label>
<input type="number" id="monthly-goal" min="0" step="0.5" class="study-input">
</div>
<button class="add-btn" onclick="saveGoals()" style="margin-top: 20px; width: 100%;">
<i class="fas fa-save"></i> Salvar Metas
</button>
</div>
</div>
</div>
<div class="study-data-buttons">
<button class="study-data-btn" onclick="exportStudyData()">
<i class="fas fa-file-export"></i>
Exportar
</button>
<button class="study-data-btn import" onclick="importStudyData()">
<i class="fas fa-file-import"></i>
Importar
</button>
</div>
<script>
// ==============================================
// FUNÇÕES ADICIONAIS IMPLEMENTADAS (AGORA NO INÍCIO PARA EVITAR ERROS)
// ==============================================
// 1. MARCAÇÃO DE DIAS CONCLUÍDOS NO CALENDÁRIO
function markCompletedDays() {
    const dateElements = document.querySelectorAll('.calendar-grid .date');
    
    dateElements.forEach(dateElement => {
        // Extrai a data do elemento
        const date = dateElement.getAttribute('data-date');
        if (!date) return;
        
        // Verifica se há sessões para esta data
        const sessions = JSON.parse(localStorage.getItem(`sessions-${date}`) || '[]');
        if (sessions.length > 0) {
            dateElement.classList.add('completed');
        } else {
            dateElement.classList.remove('completed');
        }
    });
}
// 2. FUNÇÕES PARA EDIÇÃO DE DISCIPLINAS
function enableSubjectEdit(item, subject) {
    item.classList.add('edit-mode');
    const input = item.querySelector('.subject-edit-input');
    input.value = subject;
    input.focus();
}
function saveSubjectEdit(item, oldSubject) {
    const newSubject = item.querySelector('.subject-edit-input').value.trim();
    if (!newSubject) return;
    item.classList.remove('edit-mode');
    const subjectText = item.querySelector('.subject-text');
    subjectText.textContent = newSubject;
    
    // Atualiza no localStorage
    const subjects = JSON.parse(localStorage.getItem('customSubjects')) || [];
    const index = subjects.indexOf(oldSubject);
    if (index !== -1) {
        subjects[index] = newSubject;
        localStorage.setItem('customSubjects', JSON.stringify(subjects));
    }
    
    // Atualiza todas as referências
    updateSubjectInSessions(oldSubject, newSubject);
    updateSubjectsDropdown();
    updateDashboard();
}
function updateSubjectInSessions(oldSubject, newSubject) {
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('sessions-')) {
            const sessions = JSON.parse(localStorage.getItem(key));
            const updatedSessions = sessions.map(session => {
                if (session.subject === oldSubject) {
                    return {...session, subject: newSubject};
                }
                return session;
            });
            localStorage.setItem(key, JSON.stringify(updatedSessions));
        }
    }
}
// 3. ATUALIZAÇÃO DA FUNÇÃO OPENSUBJECTSMODAL PARA ADICIONAR EDIÇÃO
function openSubjectsModal() {
    const subjects = JSON.parse(localStorage.getItem('customSubjects')) || [];
    elements.subjectListContainer.innerHTML = '';
    
    subjects.forEach(subject => {
        const div = document.createElement('div');
        div.className = 'subject-list-item';
        div.innerHTML = `
            <span class="subject-text">${subject}</span>
            <input type="text" class="subject-edit-input">
            <div class="subject-actions">
                <button class="subject-action-btn use" onclick="useSubject('${subject}')">
                    <i class="fas fa-check"></i>
                </button>
                <button class="subject-action-btn edit" onclick="enableSubjectEdit(this.parentElement.parentElement, '${subject}')">
                    <i class="fas fa-pen"></i>
                </button>
                <button class="subject-action-btn delete" onclick="deleteSubject('${subject}')">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        
        // Adiciona evento para salvar ao pressionar Enter
        const input = div.querySelector('.subject-edit-input');
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                saveSubjectEdit(div, subject);
            }
        });
        
        // Adiciona evento para salvar ao perder o foco
        input.addEventListener('blur', () => {
            saveSubjectEdit(div, subject);
        });
        
        elements.subjectListContainer.appendChild(div);
    });
    
    elements.subjectsModal.classList.add('active');
}
function closeSubjectsModal() {
    elements.subjectsModal.classList.remove('active');
}
function useSubject(subject) {
    elements.studySubject.value = subject;
    closeSubjectsModal();
}
function deleteSubject(subject) {
    const subjects = JSON.parse(localStorage.getItem('customSubjects')) || [];
    const newSubjects = subjects.filter(s => s !== subject);
    localStorage.setItem('customSubjects', JSON.stringify(newSubjects));
    openSubjectsModal();
    updateSubjectsDropdown();
}
function addNewSubject() {
    const subject = elements.newSubject.value.trim();
    if (subject) {
        addCustomSubject(subject);
        elements.newSubject.value = '';
        openSubjectsModal();
    }
}
// Configurações Iniciais
const today = new Date();
let currentMonth = parseInt(localStorage.getItem('currentMonth')) || today.getMonth();
let currentYear = parseInt(localStorage.getItem('currentYear')) || today.getFullYear();
let selectedDate = null;
let subjectChart = null;
const DAILY_GOAL = 4 * 60; // 4 horas em minutos
// Metas do usuário
let weeklyGoal = parseInt(localStorage.getItem('weeklyGoal')) || 20 * 60; // 20 horas em minutos
let monthlyGoal = parseInt(localStorage.getItem('monthlyGoal')) || 80 * 60; // 80 horas em minutos
// Elementos DOM
const elements = {
    monthYear: document.getElementById('month-year'),
    calendarGrid: document.getElementById('calendar-grid'),
    prevButton: document.getElementById('prev'),
    nextButton: document.getElementById('next'),
    dayDetails: document.getElementById('day-details'),
    calendar: document.getElementById('calendar'),
    dayTitle: document.getElementById('day-title'),
    studySubject: document.getElementById('study-subject'),
    sessionList: document.getElementById('session-list'),
    totalTime: document.getElementById('total-time'),
    studyProgress: document.getElementById('study-progress'),
    totalStudied: document.getElementById('total-studied'),
    subjectChart: document.getElementById('subjectChart'),
    topSubjects: document.getElementById('topSubjects'),
    dailyAverage: document.getElementById('daily-average'),
    studyTime: document.getElementById('study-time'),
    sliderValue: document.getElementById('slider-value'),
    subjectsModal: document.getElementById('subjects-modal'),
    subjectListContainer: document.getElementById('subject-list-container'),
    newSubject: document.getElementById('new-subject'),
    chartLegend: document.getElementById('chart-legend'),
    themeToggle: document.getElementById('theme-toggle'),
    goalModal: document.getElementById('goal-modal'),
    weeklyProgress: document.getElementById('weekly-progress'),
    monthlyProgress: document.getElementById('monthly-progress'),
    weeklyValue: document.getElementById('weekly-value'),
    monthlyValue: document.getElementById('monthly-value'),
    notification: document.getElementById('notification')
};
const months = [
    'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
];
// Funções do Calendário
function renderCalendar(month, year) {
    elements.calendarGrid.innerHTML = '<div class="day">Dom</div><div class="day">Seg</div><div class="day">Ter</div><div class="day">Qua</div><div class="day">Qui</div><div class="day">Sex</div><div class="day">Sáb</div>';
    elements.monthYear.textContent = `${months[month]} ${year}`;
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    for (let i = 0; i < firstDay; i++) {
        elements.calendarGrid.appendChild(document.createElement('div'));
    }
    for (let date = 1; date <= daysInMonth; date++) {
        const dateCell = document.createElement('div');
        dateCell.className = 'date';
        dateCell.textContent = date;
        dateCell.setAttribute('data-date', `${date}-${month+1}-${year}`);
        if (date === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
            dateCell.classList.add('today');
        }
        const tasks = loadTasks(`${date}-${month + 1}-${year}`);
        if (Object.values(tasks).some(arr => arr.length > 0)) {
            const dot = document.createElement('div');
            dot.className = 'task-dot';
            dateCell.appendChild(dot);
        }
        dateCell.onclick = () => openDayDetails(date, month, year);
        elements.calendarGrid.appendChild(dateCell);
    }
    // Marcar dias completos
    markCompletedDays();
}
// CORREÇÃO: Função loadTasks atualizada para garantir que a categoria "corrections" exista
const getStorageKey = (date) => `tasks-${date}`;
const loadTasks = (date) => {
    const key = getStorageKey(date);
    const savedData = localStorage.getItem(key);
    let tasks;
    if (savedData) {
        tasks = JSON.parse(savedData);
        // Garante que a categoria 'corrections' exista
        if (!tasks.hasOwnProperty('corrections')) {
            tasks.corrections = [];
        }
    } else {
        // Inicializa com todas as categorias, incluindo 'corrections'
        tasks = {
            questions: [],
            lessons: [],
            flashcards: [],
            corrections: []
        };
    }
    return tasks;
};
const saveTasks = (date, tasks) => localStorage.setItem(getStorageKey(date), JSON.stringify(tasks));
// Funções de Tarefas
function openDayDetails(date, month, year) {
    selectedDate = `${date}-${month + 1}-${year}`;
    elements.dayTitle.textContent = `${date} de ${months[month]} ${year}`;
    const tasks = loadTasks(selectedDate);
    for (const category in tasks) {
        const list = document.getElementById(category);
        list.innerHTML = '';
        tasks[category].forEach(task => createTaskItem(category, task.text, task.completed));
    }
    updateStudyDisplay();
    elements.calendar.classList.remove('active');
    elements.dayDetails.classList.add('active');
}
function createTaskItem(category, text, completed = false) {
    const li = document.createElement('li');
    li.className = 'task-item';
    const textSpan = document.createElement('span');
    textSpan.className = 'task-text';
    textSpan.contentEditable = true;
    textSpan.textContent = text;
    textSpan.onblur = () => updateTaskText(category, text, textSpan.textContent);
    if (completed) {
        textSpan.style.textDecoration = 'line-through';
        textSpan.style.opacity = '0.7';
    }
    const completeBtn = document.createElement('button');
    completeBtn.className = 'task-btn complete';
    completeBtn.innerHTML = '<i class="fas fa-check"></i>';
    completeBtn.onclick = () => toggleTaskComplete(textSpan, category, text);
    const removeBtn = document.createElement('button');
    removeBtn.className = 'task-btn remove';
    removeBtn.innerHTML = '<i class="fas fa-trash"></i>';
    removeBtn.onclick = () => {
        li.remove();
        updateTasks(category, text, false, true);
    };
    li.append(textSpan, completeBtn, removeBtn);
    document.getElementById(category).appendChild(li);
}
function toggleTaskComplete(element, category, oldText) {
    const completed = element.style.textDecoration === 'line-through';
    element.style.textDecoration = completed ? 'none' : 'line-through';
    element.style.opacity = completed ? '1' : '0.7';
    updateTasks(category, oldText, !completed);
}
function updateTasks(category, oldText, completed = false, remove = false) {
    const tasks = loadTasks(selectedDate);
    if (remove) {
        tasks[category] = tasks[category].filter(t => t.text !== oldText);
    } else {
        const existingIndex = tasks[category].findIndex(t => t.text === oldText);
        if (existingIndex > -1) {
            tasks[category][existingIndex] = { text: tasks[category][existingIndex].text, completed };
        } else {
            tasks[category].push({ text: oldText, completed });
        }
    }
    saveTasks(selectedDate, tasks);
}
function updateTaskText(category, oldText, newText) {
    const tasks = loadTasks(selectedDate);
    const taskIndex = tasks[category].findIndex(t => t.text === oldText);
    if (taskIndex > -1) {
        tasks[category][taskIndex].text = newText;
        saveTasks(selectedDate, tasks);
    }
}
// Funções de Estudo
function addStudySession() {
    const subject = elements.studySubject.value;
    const minutes = parseInt(elements.studyTime.value);
    if (!subject || minutes === 0) {
        alert('Selecione uma disciplina e escolha o tempo!');
        return;
    }
    // Adiciona a matéria à lista personalizada
    addCustomSubject(subject);
    const session = {
        subject,
        minutes: minutes,
        date: selectedDate,
        timestamp: new Date().toISOString()
    };
    const sessions = JSON.parse(localStorage.getItem(`sessions-${selectedDate}`) || '[]');
    sessions.push(session);
    localStorage.setItem(`sessions-${selectedDate}`, JSON.stringify(sessions));
    updateStudyDisplay();
    clearStudyInputs();
    updateDashboard();
    // Marcar dia como completo
    markCompletedDays();
}
function updateStudyDisplay() {
    const sessions = JSON.parse(localStorage.getItem(`sessions-${selectedDate}`) || '[]');
    elements.sessionList.innerHTML = '';
    let totalMinutes = 0;
    sessions.forEach(session => {
        totalMinutes += session.minutes;
        const li = document.createElement('li');
        li.className = 'session-item';
        li.innerHTML = `
            <div class="session-info">
                <span class="subject-name">${session.subject}</span>
                <span class="session-time">${Math.floor(session.minutes/60)}h ${(session.minutes%60).toString().padStart(2, '0')}m</span>
                <span class="session-time">${new Date(session.timestamp).toLocaleTimeString()}</span>
            </div>
            <div class="session-actions">
                <button class="task-btn remove" onclick="deleteStudySession('${session.timestamp}')">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        elements.sessionList.appendChild(li);
    });
    elements.totalTime.textContent = `${Math.floor(totalMinutes/60)}h ${(totalMinutes%60).toString().padStart(2, '0')}m`;
    elements.studyProgress.style.width = `${Math.min((totalMinutes / DAILY_GOAL) * 100, 100)}%`;
}
function deleteStudySession(timestamp) {
    const sessions = JSON.parse(localStorage.getItem(`sessions-${selectedDate}`) || '[]')
        .filter(session => session.timestamp !== timestamp);
    localStorage.setItem(`sessions-${selectedDate}`, JSON.stringify(sessions));
    updateStudyDisplay();
    updateDashboard();
    // Marcar dia como completo
    markCompletedDays();
}
// Funções do Dashboard
function updateDashboard() {
    const allSessions = getAllSessions();
    const stats = calculateStats(allSessions);
    updateTotalTime(stats.total);
    updateSubjectChart(stats.bySubject);
    updateTopSubjects(stats.bySubject);
    updateDailyAverage(stats.dailyAverage);
    updateGoalsProgress(); // Atualiza as barras de progresso de metas
}
function getAllSessions() {
    const sessions = [];
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('sessions-')) {
            sessions.push(...JSON.parse(localStorage.getItem(key)));
        }
    }
    return sessions;
}
function calculateStats(sessions) {
    const stats = {
        total: 0,
        bySubject: {},
        days: {},
        dailyAverage: 0
    };
    sessions.forEach(session => {
        stats.total += session.minutes;
        if (!stats.bySubject[session.subject]) {
            stats.bySubject[session.subject] = { minutes: 0, count: 0 };
        }
        stats.bySubject[session.subject].minutes += session.minutes;
        stats.bySubject[session.subject].count++;
        const date = session.date;
        stats.days[date] = (stats.days[date] || 0) + session.minutes;
    });
    const totalDays = Object.keys(stats.days).length;
    stats.dailyAverage = totalDays > 0 ? stats.total / totalDays : 0;
    return stats;
}
function updateTotalTime(totalMinutes) {
    const hours = Math.floor(totalMinutes / 60);
    const mins = totalMinutes % 60;
    elements.totalStudied.textContent = `${hours}h ${mins.toString().padStart(2, '0')}m`;
}
// Função para gerar cores pastel únicas
function generatePastelColors(count) {
    const colors = [];
    for (let i = 0; i < count; i++) {
        // Gera cores pastel com diferentes matizes
        const hue = (i * 360 / Math.max(count, 1)) % 360;
        colors.push(`hsl(${hue}, 70%, 80%)`);
    }
    return colors;
}
function updateSubjectChart(data) {
    const ctx = elements.subjectChart.getContext('2d');
    const subjects = Object.keys(data);
    const values = Object.values(data).map(d => d.minutes);
    // Gerar cores pastel para todas as disciplinas
    const backgroundColors = generatePastelColors(subjects.length);
    if (subjectChart) subjectChart.destroy();
    // Gráfico de rosca com paleta pastel
    subjectChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: subjects,
            datasets: [{
                data: values,
                backgroundColor: backgroundColors,
                borderColor: '#FFFFFF',
                borderWidth: 2,
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '65%',
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const minutes = context.raw;
                            const hours = Math.floor(minutes / 60);
                            const mins = minutes % 60;
                            return `${context.label}: ${hours}h ${mins}m`;
                        }
                    }
                }
            }
        }
    });
    // Atualiza a legenda
    updateChartLegend(subjects, backgroundColors, values);
}
function updateChartLegend(labels, colors, values) {
    elements.chartLegend.innerHTML = '';
    labels.forEach((label, index) => {
        const minutes = values[index];
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        const div = document.createElement('div');
        div.className = 'legend-item';
        div.innerHTML = `
            <div class="legend-color" style="background: ${colors[index]}"></div>
            <div class="legend-text" title="${label}">${label}</div>
            <div>${hours}h ${mins.toString().padStart(2, '0')}m</div>
        `;
        elements.chartLegend.appendChild(div);
    });
}
function updateTopSubjects(data) {
    const sorted = Object.entries(data).sort((a, b) => b[1].minutes - a[1].minutes);
    const list = document.getElementById('topSubjects');
    list.innerHTML = '';
    sorted.slice(0, 5).forEach(([subject, info]) => {
        const minutes = info.minutes;
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        const li = document.createElement('li');
        li.className = 'subject-item';
        li.innerHTML = `
            <span>${subject}</span>
            <span>${hours}h ${mins.toString().padStart(2, '0')}m</span>
        `;
        list.appendChild(li);
    });
}
function updateDailyAverage(minutes) {
    const hours = Math.floor(minutes / 60);
    const mins = Math.round(minutes % 60);
    elements.dailyAverage.textContent = `${hours}h ${mins.toString().padStart(2, '0')}m`;
}
// Funções Auxiliares
function clearStudyInputs() {
    elements.studySubject.value = '';
    elements.studyTime.value = 0;
    elements.sliderValue.textContent = '0h 00m';
    document.querySelectorAll('.time-btn').forEach(btn => {
        btn.classList.remove('active');
    });
}
// Funções de Matérias Personalizadas
function addCustomSubject(subject) {
    if (!subject) return;
    const subjects = JSON.parse(localStorage.getItem('customSubjects')) || [];
    // Evita duplicatas
    if (!subjects.includes(subject)) {
        subjects.push(subject);
        localStorage.setItem('customSubjects', JSON.stringify(subjects));
        updateSubjectsDropdown();
    }
}
// Atualizar o dropdown de disciplinas
function updateSubjectsDropdown() {
    const subjects = JSON.parse(localStorage.getItem('customSubjects')) || [];
    const dropdown = elements.studySubject;
    // Remove todas as opções exceto a primeira
    while (dropdown.options.length > 1) {
        dropdown.remove(1);
    }
    // Adiciona as disciplinas cadastradas
    subjects.forEach(subject => {
        const option = document.createElement('option');
        option.value = subject;
        option.textContent = subject;
        dropdown.appendChild(option);
    });
}
// Configurar botões de tempo
function setupTimeButtons() {
    document.querySelectorAll('.time-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const minutes = parseInt(this.dataset.minutes);
            const currentMinutes = parseInt(elements.studyTime.value) || 0;
            const newMinutes = currentMinutes + minutes;
            // Limitar a 60 minutos
            if (newMinutes > 60) {
                elements.studyTime.value = 60;
            } else {
                elements.studyTime.value = newMinutes;
            }
            // Atualiza o valor exibido
            const hours = Math.floor(elements.studyTime.value / 60);
            const mins = elements.studyTime.value % 60;
            elements.sliderValue.textContent = `${hours}h ${mins.toString().padStart(2, '0')}m`;
            // Dispara o evento do slider para atualizar a interface
            elements.studyTime.dispatchEvent(new Event('input'));
        });
    });
}
// Definir tempo personalizado
function setCustomTime() {
    const minutes = parseInt(document.getElementById('custom-minutes').value);
    if (minutes >= 0 && minutes <= 60) {
        elements.studyTime.value = minutes;
        // Atualiza o valor exibido
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        elements.sliderValue.textContent = `${hours}h ${mins.toString().padStart(2, '0')}m`;
        // Dispara o evento do slider para atualizar a interface
        elements.studyTime.dispatchEvent(new Event('input'));
    } else {
        alert('Insira um valor entre 0 e 60 minutos');
    }
}
// FUNÇÕES PARA AS METAS DE ESTUDO (CORRIGIDAS)
// Função para calcular o tempo estudado em um mês específico (0-11)
function calculateMonthlyTime(month, year) {
    let totalMinutes = 0;
    // O mês em JavaScript: 0-11, mas nossa chave usa mês de 1-12
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    for (let day = 1; day <= daysInMonth; day++) {
        const dateKey = `${day}-${month + 1}-${year}`;
        const sessions = JSON.parse(localStorage.getItem(`sessions-${dateKey}`) || '[]');
        sessions.forEach(session => {
            totalMinutes += session.minutes;
        });
    }
    return totalMinutes;
}
// Função para calcular o tempo estudado em um intervalo de datas (objetos Date)
function calculateWeeklyTime(startDate, endDate) {
    let totalMinutes = 0;
    const current = new Date(startDate);
    const last = new Date(endDate);
    while (current <= last) {
        const day = current.getDate();
        const month = current.getMonth() + 1; // porque no formato dd-mm-yyyy, o mês é 1-12
        const year = current.getFullYear();
        const dateKey = `${day}-${month}-${year}`;
        const sessions = JSON.parse(localStorage.getItem(`sessions-${dateKey}`) || '[]');
        sessions.forEach(session => {
            totalMinutes += session.minutes;
        });
        current.setDate(current.getDate() + 1); // Avança um dia
    }
    return totalMinutes;
}
function updateGoalsProgress() {
    // Calcular tempo estudado no mês exibido no calendário
    const monthlyMinutes = calculateMonthlyTime(currentMonth, currentYear);
    // Calcular tempo estudado na semana atual (dentro do mês exibido) apenas se for o mês atual
    let weeklyMinutes = 0;
    const today = new Date();
    // Verificar se o mês exibido é o mês atual
    if (currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
        const startOfWeek = new Date(today);
        startOfWeek.setDate(today.getDate() - today.getDay()); // Domingo da semana
        startOfWeek.setHours(0, 0, 0, 0);
        const endOfWeek = new Date(today);
        endOfWeek.setDate(today.getDate() + (6 - today.getDay())); // Sábado da semana
        endOfWeek.setHours(23, 59, 59, 999);
        weeklyMinutes = calculateWeeklyTime(startOfWeek, endOfWeek);
    }
    // Atualizar progresso semanal
    const weeklyProgress = weeklyGoal > 0 ? Math.min((weeklyMinutes / weeklyGoal) * 100, 100) : 0;
    elements.weeklyProgress.style.width = `${weeklyProgress}%`;
    elements.weeklyValue.textContent = `${(weeklyMinutes/60).toFixed(1)}/${weeklyGoal/60} horas`;
    // Atualizar progresso mensal
    const monthlyProgress = monthlyGoal > 0 ? Math.min((monthlyMinutes / monthlyGoal) * 100, 100) : 0;
    elements.monthlyProgress.style.width = `${monthlyProgress}%`;
    elements.monthlyValue.textContent = `${(monthlyMinutes/60).toFixed(1)}/${monthlyGoal/60} horas`;
    // Verificar se atingiu as metas (apenas para o mês atual)
    if (monthlyProgress >= 100) {
        const lastNotifiedMonth = localStorage.getItem('lastNotifiedMonth');
        const currentMonthKey = `${currentMonth}-${currentYear}`;
        if (lastNotifiedMonth !== currentMonthKey) {
            showGoalAchieved('mensal');
            localStorage.setItem('lastNotifiedMonth', currentMonthKey);
        }
    }
}
// Exibir notificação de meta atingida
function showGoalAchieved(type) {
    elements.notification.textContent = `Parabéns! Você atingiu sua meta ${type}! 🎉`;
    elements.notification.classList.add('show');
    setTimeout(() => {
        elements.notification.classList.remove('show');
    }, 3000);
}
// Alternância de tema
function toggleTheme() {
    document.body.classList.toggle('light-theme');
    const isLight = document.body.classList.contains('light-theme');
    localStorage.setItem('theme', isLight ? 'light' : 'dark');
    if (isLight) {
        elements.themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    } else {
        elements.themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    }
    // Atualiza o gráfico quando o tema muda
    updateDashboard();
}
// Verificar tema salvo
function checkSavedTheme() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
        document.body.classList.add('light-theme');
        elements.themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }
}
// ==============================================
// NOVAS FUNÇÕES PARA GERENCIAMENTO DE METAS
// ==============================================
function openGoalModal() {
    // Preencher os campos com as metas atuais (convertendo para horas)
    document.getElementById('weekly-goal').value = (weeklyGoal / 60).toFixed(1);
    document.getElementById('monthly-goal').value = (monthlyGoal / 60).toFixed(1);
    elements.goalModal.classList.add('active');
}
function closeGoalModal() {
    elements.goalModal.classList.remove('active');
}
function saveGoals() {
    // Obter os valores dos inputs e converter para minutos
    const weeklyHours = parseFloat(document.getElementById('weekly-goal').value);
    const monthlyHours = parseFloat(document.getElementById('monthly-goal').value);
    if (!isNaN(weeklyHours)) {
        weeklyGoal = weeklyHours * 60;
        localStorage.setItem('weeklyGoal', weeklyGoal);
    }
    if (!isNaN(monthlyHours)) {
        monthlyGoal = monthlyHours * 60;
        localStorage.setItem('monthlyGoal', monthlyGoal);
    }
    // Atualizar as barras de progresso
    updateGoalsProgress();
    closeGoalModal();
    // Mostrar notificação
    showNotification('Metas atualizadas com sucesso!');
}
function showNotification(message) {
    elements.notification.textContent = message;
    elements.notification.classList.add('show');
    setTimeout(() => {
        elements.notification.classList.remove('show');
    }, 3000);
}
// Event Listeners
elements.prevButton.addEventListener('click', () => {
    currentMonth--;
    if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
    }
    localStorage.setItem('currentMonth', currentMonth);
    localStorage.setItem('currentYear', currentYear);
    renderCalendar(currentMonth, currentYear);
    updateDashboard(); // Atualizar metas ao mudar mês
});
elements.nextButton.addEventListener('click', () => {
    currentMonth++;
    if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
    }
    localStorage.setItem('currentMonth', currentMonth);
    localStorage.setItem('currentYear', currentYear);
    renderCalendar(currentMonth, currentYear);
    updateDashboard(); // Atualizar metas ao mudar mês
});
document.querySelectorAll('.add-btn').forEach(btn => {
    if (btn.dataset.category) {
        btn.addEventListener('click', (e) => {
            const category = e.target.dataset.category;
            const input = document.getElementById(`new-${category}`);
            if (input.value.trim()) {
                createTaskItem(category, input.value.trim());
                updateTasks(category, input.value.trim());
                input.value = '';
            }
        });
    }
});
function closeDayDetails() {
    elements.dayDetails.classList.remove('active');
    elements.calendar.classList.add('active');
    updateDashboard();
}
// Evento para o slider de tempo
elements.studyTime.addEventListener('input', function() {
    const minutes = parseInt(this.value);
    const hours = Math.floor(minutes / 60);
    const mins = minutes % 60;
    elements.sliderValue.textContent = `${hours}h ${mins.toString().padStart(2, '0')}m`;
});
// Função para Exportar Dados
function exportStudyData() {
    const exportData = {};
    // Captura todos os dados relevantes do localStorage
    for(let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if(key.startsWith('tasks-') || key.startsWith('sessions-') ||
            key === 'currentMonth' || key === 'currentYear' || key === 'customSubjects' ||
            key === 'weeklyGoal' || key === 'monthlyGoal') {
            exportData[key] = localStorage.getItem(key);
        }
    }
    // Cria e faz download do arquivo
    const dataStr = JSON.stringify(exportData, null, 2);
    const blob = new Blob([dataStr], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `study_backup_${new Date().toISOString().slice(0,10)}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}
// Função para Importar Dados
function importStudyData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const importedData = JSON.parse(e.target.result);
                // Limpa dados existentes relacionados ao app
                Object.keys(importedData).forEach(key => {
                    localStorage.removeItem(key);
                    localStorage.setItem(key, importedData[key]);
                });
                alert('Dados importados com sucesso! Atualize a página.');
            } catch (error) {
                alert('Erro na importação: Arquivo inválido');
            }
        };
        reader.readAsText(file);
    };
    input.click();
}
// Inicialização
function init() {
    renderCalendar(currentMonth, currentYear);
    updateDashboard();
    updateSubjectsDropdown();
    setupTimeButtons();
    checkSavedTheme();
    // Event listeners adicionais
    elements.themeToggle.addEventListener('click', toggleTheme);
    // Atualizar as metas
    updateGoalsProgress();
    // Atualiza o slider ao carregar
    elements.studyTime.dispatchEvent(new Event('input'));
    // Marcar dias completos
    markCompletedDays();
}
// Executa a inicialização quando o documento estiver pronto
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>